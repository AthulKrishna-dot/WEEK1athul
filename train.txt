# train.py

import os
from dataload import load_dataset
from model import create_model

DATASET_PATH = "/content/waste-classification"   # Change if needed
SAVE_MODEL_PATH = "/content/waste_model.h5"

def train_model():
    print("âœ… Loading dataset...")
    train_data, val_data = load_dataset(DATASET_PATH)

    print("âœ… Creating model...")
    model = create_model(train_data.num_classes)

    print("âœ… Training started...")
    history = model.fit(
        train_data,
        validation_data=val_data,
        epochs=10
    )

    print("âœ… Saving model...")
    model.save(SAVE_MODEL_PATH)

    print("ðŸŽ‰ Training complete! Model saved at:", SAVE_MODEL_PATH)

if __name__ == "__main__":
    train_model()
